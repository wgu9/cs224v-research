# 工程实施要点（Scope / Tool / Loop）

## 1) Scope Guard（作用域守护）
- 定义 **允许集合**：文件/目录/API/DOM 元素白名单；对每个动作进行前置校验。
- 记录 **越界事件**（时间、对象、动作类型、上下文切片），用于线上监控与离线评估。
- 对越界：拦截 + 生成“再聚焦”提示；必要时回滚到最近检查点。

## 2) Tool Use Monitor（工具调用监控）
- 统计调用→目标推进 **贡献率**（可用启发式或学习式 credit assignment）。
- 标记 **空收益/无关** 调用与 **重复** 调用；超过阈值触发提醒或重规划。
- 在多代理/多工具系统中启用 **能力/角色约束**，避免“越权”调用。

## 3) Looping Detector（循环/无进展检测）
- 动作序列相似度 + 环检测（固定窗口内同构/近似重复）＋状态差分≈0 作为合取条件。
- 触发策略：先提醒（提示替代策略/检索新信息）→ 再早停（保护资源/安全）。
- 将循环特征写入 **失败记忆**，供后续策略检索避免“再犯”。

## 4) Activation-Delta Watchdog（旁路探测器）
- 维护小型线性/MLP 探测头，输入为新上下文注入前/后的层激活差分。
- 阈值触发：产生命中高的“早期漂移预警”，并驱动 *Remind / Re-plan / Rollback*。

## 5) 评测报表（可直接落库）
- 作用域违规/百步、无关工具占比、循环次数&时长、指令遵循曲线、激活差分 AUC。
- 按基准与任务类型切分（编码/工具对话/Web 导航），支持消融与对照。

---
**集成建议**：以“守护（规则） + 探测（学习） + 干预（策略）”的三层结构组合；保持旁路并行以降低对主循环的干扰。
